{% extends 'base.html' %}
{% load static %}

{% block title %}Available Courses{% endblock %}

{% block content %}
<section id="courseListSection">
    <h2>Available Courses</h2>
    
    <!-- Search and Filter Form -->
    <div class="search-filter-container">
        <form method="GET" class="search-form">
            <input type="text" name="q" value="{{ query }}" placeholder="Search courses...">
            
            <select name="level">
                <option value="">All Levels</option>
                {% for level_code, level_name in levels %}
                <option value="{{ level_code }}" {% if level == level_code %}selected{% endif %}>
                    {{ level_name }}
                </option>
                {% endfor %}
            </select>
            
            <select name="category">
                <option value="">All Categories</option>
                {% for cat in categories %}
                <option value="{{ cat }}" {% if category == cat %}selected{% endif %}>
                    {{ cat }}
                </option>
                {% endfor %}
            </select>
            
            <button type="submit">Search</button>
        </form>
    </div>

    <div class="course-list">
        {% for course in courses %}
        <div class="course-item">
            <div class="course-image">
                {% if course.thumbnail %}
                    <img src="{{ course.thumbnail.url }}" alt="{{ course.title }}" class="course-thumbnail">
                {% else %}
                    <img src="{% static 'images/default-course.jpg' %}" alt="Default course image" class="course-thumbnail">
                {% endif %}
            </div>
            <h3>{{ course.title }}</h3>
            <p>{{ course.description|truncatewords:30 }}</p>
            <div class="course-meta">
                <span class="level">{{ course.get_level_display }}</span>
                <span class="price">${{ course.price }}</span>
                <span class="duration">{{ course.duration }} mins</span>
                <span class="instructor">By {{ course.instructor.get_full_name }}</span>
            </div>
            <a href="{% url 'course_detail' course.id %}" class="learn-more-btn">Learn More</a>
        </div>
        {% empty %}
        <p>No courses found matching your criteria.</p>
        {% endfor %}
    </div>
</section>
{% endblock %}